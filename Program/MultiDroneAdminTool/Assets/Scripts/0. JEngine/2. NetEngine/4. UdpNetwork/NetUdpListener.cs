using System;
using System.Collections.Generic;
using System.Net;
using System.Net.Sockets;
#if !OLD_DOT_NET
using System.Threading.Tasks;
#endif


namespace J2y.Network
{
	//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
	//
	// NetUdpListener
	//
	//
	//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

	public class NetUdpListener : NetUdpPeer_base
	{
		//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
		// Variable
		//
		//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


		#region Variable

		protected IPEndPoint _listen_on;
		
		#endregion





		//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
		// 0. Base Methods
		//
		//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

		#region [Init]
		//------------------------------------------------------------------------------------------------------------------------------------------------------
		public NetUdpListener()
		{ }
		#endregion



		//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
		// UDP 서버
		//
		//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

		#region [서버] 시작
		//------------------------------------------------------------------------------------------------------------------------------------------------------
		public virtual void StartServer(int port)
		{
			StartServer(new IPEndPoint(IPAddress.Any, port));
		}
		//------------------------------------------------------------------------------------------------------------------------------------------------------
		public virtual void StartServer(IPEndPoint endpoint)
		{
			_listen_on = endpoint;
			_net_client = new UdpClient(_listen_on);
		}
		#endregion

		#region [서버] 닫기
		//------------------------------------------------------------------------------------------------------------------------------------------------------
		public virtual void CloseServer()
		{			
#if !OLD_DOT_NET
			_net_client.Close();
#endif
			JLogger.WriteFormat("[JUdpListener] CloseServer");
		}
		#endregion
				
	}

}

